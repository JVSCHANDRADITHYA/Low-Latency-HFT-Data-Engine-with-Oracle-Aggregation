name: Daily Repo Health Check

on:
  schedule:
    - cron: "40 18 * * *"   # runs daily at midnight UTC
  workflow_dispatch:

jobs:
  validate:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      # --- YAML validation ---
      - name: Validate YAML files
        run: |
          sudo apt-get install -y yamllint
          yamllint .

      # --- JSON validation ---
      - name: Validate JSON files
        run: |
          if find . -name "*.json" | grep -q .; then
            for f in $(find . -name "*.json"); do
              echo "Checking $f"
              jq empty "$f"
            done
          else
            echo "No JSON files found — skipping."
          fi

      # --- Python linting (only if python files exist) ---
      - name: Optional Python linting
        run: |
          if find . -name "*.py" | grep -q .; then
            pip install flake8
            flake8 .
          else
            echo "No Python files found — skipping."
          fi
